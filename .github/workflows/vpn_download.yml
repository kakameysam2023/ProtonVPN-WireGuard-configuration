name: ProtonVPN Config Downloader

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * *'

jobs:
  download_and_send:
    runs-on: ubuntu-latest
    
    env:
      VPN_USERNAME: ${{ secrets.VPN_USERNAME }}
      VPN_PASSWORD: ${{ secrets.VPN_PASSWORD }}
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      PYTHONUNBUFFERED: 1

    steps:
    - name: â¬‡ï¸ Checkout Repository
      uses: actions/checkout@v4

    - name: ğŸ Setup Python 3.10
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        # --- Ø®Ø· Ú©Ø´ Ú©Ø±Ø¯Ù† Ú©Ù‡ Ø¨Ø§Ø¹Ø« Ø®Ø·Ø§ Ù…ÛŒ Ø´Ø¯ Ø­Ø°Ù Ø´Ø¯ ---
        # cache: 'pip' 
        # ----------------------------------------------

    - name: ğŸ“¦ Install Python Dependencies & Chrome Driver
      run: |
        # Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬ Ù‡Ø§ÛŒ Ù¾Ø§ÛŒØªÙˆÙ†
        pip install selenium requests webdriver-manager
        
        # Ù†ØµØ¨ Ù…Ø±ÙˆØ±Ú¯Ø± Ú©Ø±ÙˆÙ… Ùˆ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ù‡Ø§ÛŒ Headless
        sudo apt-get update
        sudo apt-get install -y google-chrome-stable

    - name: âš™ï¸ Clear Previous Logs/Configs
      run: |
        rm -rf downloaded_configs
        rm -f downloaded_server_ids.json
        mkdir -p downloaded_configs

    - name: ğŸš€ Run ProtonVPN Downloader Script
      run: python3 proton_downloader_chrome.py
